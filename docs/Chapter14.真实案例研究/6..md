亚马逊 Prime Video 监控为什么从无服务器转向单体？如何能节省 90%的成本？下面的图表显示了迁移前后的架构比较。![](images/serverless-to-monolithic.jpeg)亚马逊 Prime Video 监控服务是什么？Prime Video 服务需要监控数千个直播流的质量。监控工具会实时自动分析流，并识别像块损坏、视频冻结和同步问题等质量问题。这是客户满意度的重要过程。有 3 个步骤：媒体转换器、缺陷检测器和实时通知。旧建筑的问题是什么？旧架构基于亚马逊 Lambda，适用于快速构建服务。然而，在高规模运行架构时并不划算。最昂贵的两个操作是：编排工作流程 - AWS 步骤函数通过状态转换向用户收费，编排每秒执行多个状态转换。数据在分布式组件之间传递 - 中间数据存储在 Amazon S3 中，以便下一阶段可以下载。当数据量较大时，下载可能会很昂贵。单体架构节省 90%的成本单体架构旨在解决成本问题。仍然有 3 个组件，但媒体转换器和缺陷检测器部署在同一流程中，节省了通过网络传输数据的成本。令人惊讶的是，这种部署架构变更的方法导致了 90%的成本节约！这是一个有趣且独特的案例研究，因为微服务已经成为科技行业中的首选和时尚选择。很高兴看到我们正在更多地讨论架构的演变，并就其优缺点进行更诚实的讨论。将组件分解为分布式微服务是有成本的。亚马逊的领导人对此有何看法？亚马逊首席技术官 Werner Vogels：“构建可演进的软件系统是一种策略，而不是一种宗教。以开放的心态重新审视您的架构是必不可少的。”前亚马逊副总裁可持续发展 Adrian Cockcroft：“Prime Video 团队已经走过了我称之为**无服务器优先**的道路……我不主张**仅限无服务器**”。