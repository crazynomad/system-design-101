迪士尼热星在比赛期间如何捕捉 50 亿个表情符号？![](../images/hotstar_emojis.jpeg)客户端通过标准的 HTTP 请求发送表情符号。您可以将 Golang 服务视为典型的 Web 服务器。选择 Golang 是因为它很好地支持并发。Golang 中的线程是轻量级的。由于写入量很高，Kafka（消息队列）被用作缓冲区。表情符号数据由一个名为 Spark 的流处理服务聚合。它每 2 秒聚合一次数据，这是可配置的。根据间隔需要做出权衡。较短的间隔意味着表情符号会更快地传递给其他客户端，但也意味着需要更多的计算资源。聚合数据被写入另一个 Kafka。PubSub 消费者从 Kafka 拉取聚合的表情数据。表情符号通过 PubSub 基础架构实时传递到其他客户端。 PubSub 基础架构很有趣。 Hotstar 考虑了以下协议：Socketio、NATS、MQTT 和 gRPC，并最终选择了 MQTT。LinkedIn 采用了类似的设计，每秒流量达到一百万个赞。